{"ast":null,"code":"var _jsxFileName = \"E:\\\\CScourse\\\\\\u89C6\\u542C\\u89C9\\\\Sound-Quality-HCI\\\\src\\\\components\\\\WaveGraph.js\";\nimport React from \"react\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport Box from \"@mui/material/Box\";\nimport { IconButton } from \"@mui/material\";\nimport PlayArrowIcon from '@mui/icons-material/PlayArrow';\nimport PauseIcon from '@mui/icons-material/Pause';\nimport Recorder from \"recorder-js\";\nimport { Download } from \"@mui/icons-material\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass WaveGraph extends React.Component {\n  constructor(props) {\n    super();\n    this.props = props;\n    this.state = {\n      waveform: null,\n      audioContext: new AudioContext(),\n      playing: false\n    };\n    this.togglePlayPause = this.togglePlayPause.bind(this);\n    this.PlayButton = this.PlayButton.bind(this);\n    this.download = this.download.bind(this);\n  }\n  componentDidMount() {\n    let wavs = WaveSurfer.create({\n      audioContext: this.state.audioContext,\n      container: `#waveform-${this.props.destination}`\n    });\n    wavs.load(document.querySelector(this.props.source));\n    wavs.on('finish', this.togglePlayPause);\n    this.setState({\n      waveform: wavs\n    });\n    setTimeout(() => {\n      document.querySelector(`#waveform-${this.props.destination}`).children[0].style.display = \"none\";\n    }, 100);\n  }\n  PlayButton() {\n    return this.state.playing ? /*#__PURE__*/_jsxDEV(PauseIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 33\n    }, this) : /*#__PURE__*/_jsxDEV(PlayArrowIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 48\n    }, this);\n  }\n  togglePlayPause() {\n    var _this$state$audioCont;\n    if (((_this$state$audioCont = this.state.audioContext) === null || _this$state$audioCont === void 0 ? void 0 : _this$state$audioCont.state) === \"suspended\") {\n      this.state.audioContext.resume();\n    }\n    this.state.waveform.playPause();\n    this.setState({\n      playing: !this.state.playing\n    });\n  }\n  async download() {\n    Recorder.download(await fetch(this.props.url).then(r => r.blob()), 'audio-file');\n  }\n  render() {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        width: \"40vw\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: this.togglePlayPause,\n        children: this.PlayButton()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        id: `waveform-${this.props.destination}`,\n        sx: {\n          width: \"70%\"\n        },\n        children: \" \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        color: \"success\",\n        title: \"download audio\",\n        \"aria-label\": \"download the ready audio\",\n        onClick: this.download,\n        children: /*#__PURE__*/_jsxDEV(Download, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }, this);\n  }\n}\nexport default WaveGraph;","map":{"version":3,"names":["React","WaveSurfer","Box","IconButton","PlayArrowIcon","PauseIcon","Recorder","Download","jsxDEV","_jsxDEV","WaveGraph","Component","constructor","props","state","waveform","audioContext","AudioContext","playing","togglePlayPause","bind","PlayButton","download","componentDidMount","wavs","create","container","destination","load","document","querySelector","source","on","setState","setTimeout","children","style","display","fileName","_jsxFileName","lineNumber","columnNumber","_this$state$audioCont","resume","playPause","fetch","url","then","r","blob","render","sx","width","alignItems","justifyContent","onClick","id","color","title"],"sources":["E:/CScourse/视听觉/Sound-Quality-HCI/src/components/WaveGraph.js"],"sourcesContent":["import React from \"react\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport Box from \"@mui/material/Box\";\nimport {IconButton} from \"@mui/material\";\nimport PlayArrowIcon from '@mui/icons-material/PlayArrow';\nimport PauseIcon from '@mui/icons-material/Pause';\nimport Recorder from \"recorder-js\";\nimport {Download} from \"@mui/icons-material\";\n\n\nclass WaveGraph extends React.Component {\n\n  constructor(props) {\n    super();\n    this.props = props\n    this.state = {\n      waveform: null,\n      audioContext: new AudioContext(),\n      playing: false\n    }\n    this.togglePlayPause = this.togglePlayPause.bind(this)\n    this.PlayButton = this.PlayButton.bind(this)\n    this.download = this.download.bind(this)\n  }\n\n  componentDidMount() {\n    let wavs = WaveSurfer.create({\n      audioContext: this.state.audioContext,\n      container: `#waveform-${this.props.destination}`\n    })\n    wavs.load(document.querySelector(this.props.source))\n    wavs.on('finish', this.togglePlayPause)\n    this.setState({waveform: wavs})\n\n    setTimeout(() => {\n      document.querySelector(`#waveform-${this.props.destination}`).children[0].style.display = \"none\"\n    }, 100)\n  }\n\n  PlayButton() {\n    return this.state.playing ? <PauseIcon/> : <PlayArrowIcon/>\n  }\n\n  togglePlayPause() {\n    if (this.state.audioContext?.state === \"suspended\") {\n      this.state.audioContext.resume()\n    }\n\n    this.state.waveform.playPause()\n    this.setState({ playing: !this.state.playing})\n  }\n\n  async download() {\n    Recorder.download(await fetch(this.props.url).then(r => r.blob()), 'audio-file');\n  }\n\n  render() {\n    return (\n        <Box sx={{width: \"40vw\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\"}}>\n          <IconButton onClick={this.togglePlayPause}>\n            {this.PlayButton()}\n          </IconButton>\n          <Box id={`waveform-${this.props.destination}`} sx={{width: \"70%\"}}> </Box>\n          <IconButton\n              color={\"success\"}\n              title={\"download audio\"}\n              aria-label={\"download the ready audio\"}\n              onClick={this.download}\n          >\n            <Download/>\n          </IconButton>\n        </Box>\n    );\n  }\n}\n\n\nexport default WaveGraph;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}